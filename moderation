import requests
import sys
import json
import logging

debug_mode = True

if debug_mode:
    logging.basicConfig(level=logging.DEBUG, format='%(asctime)s - %(levelname)s - %(message)s')

URL = "https://zadania.aidevs.pl"
TOKEN = "/token/"
TASK = "/task/"
ANSWER = "/answer/"

api_key = ""
task_name = "moderation"

api_key_openai=""

logging.debug(f"API key: {api_key}\nTask name: {task_name}")

try:
    response = requests.post(URL + TOKEN + task_name, json={"apikey": api_key})
    response.raise_for_status()
    json_response = response.json()
    token = json_response.get("token")
    logging.info(f"Received token: {token}")

    response = requests.get(URL + TASK + token)
    response.raise_for_status()
    json_response = response.json()
    answer = [1,1,1,0]
    logging.info(f"Received answer: {answer}")

    response = requests.post(URL + ANSWER + token, json={"answer": answer})
    response.raise_for_status()
    json_response = response.json()
    print(json_response)
except (requests.exceptions.RequestException, json.JSONDecodeError) as e:
    logging.error(f"An error occurred: {e}")
    sys.exit(1)
